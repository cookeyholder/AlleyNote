import{r as t,b as e}from"./DashboardLayout-BjmJ-OJc.js";import{p as n}from"./posts-D8uqMnbu.js";import{t as s}from"./toast-ChPGQGGG.js";import{c as o}from"./ConfirmationDialog-DKaQBUc8.js";import{l as a}from"./Loading-D3hznI52.js";import{r as d}from"./index-DHmEDfox.js";import"./vendor-core-DW9qjkZC.js";let i=1,r={},l={posts:[]};async function c(){var n,s,o;document.getElementById("app").innerHTML=t('\n    <div>\n      <div class="flex items-center justify-between mb-8">\n        <h1 class="text-3xl font-bold text-modern-900">æ–‡ç« ç®¡ç†</h1>\n        <a href="/admin/posts/create" data-navigo class="btn-primary">\n          âœï¸ æ–°å¢æ–‡ç« \n        </a>\n      </div>\n      \n      \x3c!-- æœå°‹èˆ‡ç¯©é¸ --\x3e\n      <div class="card mb-6">\n        <div class="flex flex-col md:flex-row gap-4">\n          <input\n            type="text"\n            id="search-input"\n            placeholder="æœå°‹æ–‡ç« æ¨™é¡Œ..."\n            class="input-field flex-1"\n          />\n          <select id="status-filter" class="input-field md:w-48">\n            <option value="">æ‰€æœ‰ç‹€æ…‹</option>\n            <option value="published">å·²ç™¼å¸ƒ</option>\n            <option value="draft">è‰ç¨¿</option>\n          </select>\n          <select id="sort-filter" class="input-field md:w-48">\n            <option value="-created_at">æœ€æ–°å„ªå…ˆ</option>\n            <option value="created_at">æœ€èˆŠå„ªå…ˆ</option>\n            <option value="title">æ¨™é¡Œ A-Z</option>\n            <option value="-title">æ¨™é¡Œ Z-A</option>\n          </select>\n          <button id="search-btn" class="btn-primary md:w-auto">æœå°‹</button>\n          <button id="reset-btn" class="btn-secondary md:w-auto">é‡ç½®</button>\n        </div>\n      </div>\n      \n      \x3c!-- æ–‡ç« åˆ—è¡¨ --\x3e\n      <div class="card">\n        <div id="posts-table-container">\n          <div class="text-center py-8">\n            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-accent-600 mx-auto"></div>\n            <p class="mt-4 text-modern-600">è¼‰å…¥ä¸­...</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  '),e(),await p(),null==(n=document.getElementById("search-btn"))||n.addEventListener("click",()=>{i=1,p()}),null==(s=document.getElementById("reset-btn"))||s.addEventListener("click",()=>{document.getElementById("search-input").value="",document.getElementById("status-filter").value="",document.getElementById("sort-filter").value="-created_at",i=1,r={},p()}),null==(o=document.getElementById("search-input"))||o.addEventListener("keypress",t=>{"Enter"===t.key&&(i=1,p())})}async function p(){var t,e,s;const o=document.getElementById("posts-table-container"),c=(null==(t=document.getElementById("search-input"))?void 0:t.value)||"",p=(null==(e=document.getElementById("status-filter"))?void 0:e.value)||"",u=(null==(s=document.getElementById("sort-filter"))?void 0:s.value)||"-created_at";a.show("è¼‰å…¥ä¸­...");try{r={search:c,status:p,sort:u,page:i,per_page:10};const t=await n.list(r),e=t.data||[],s=t.pagination||{};if(l.posts=e,a.hide(),0===e.length)return o.innerHTML=`\n        <div class="text-center py-12">\n          <div class="text-6xl mb-4">ğŸ“</div>\n          <p class="text-modern-600 mb-4">\n            ${c||p?"æ‰¾ä¸åˆ°ç¬¦åˆæ¢ä»¶çš„æ–‡ç« ":"ç›®å‰æ²’æœ‰æ–‡ç« "}\n          </p>\n          ${c||p?"":'\n            <a href="/admin/posts/create" data-navigo class="btn-primary inline-block">æ–°å¢ç¬¬ä¸€ç¯‡æ–‡ç« </a>\n          '}\n        </div>\n      `,void d.updatePageLinks();o.innerHTML=`\n      <table class="w-full">\n        <thead class="bg-modern-50">\n          <tr>\n            <th class="px-6 py-3 text-left text-xs font-medium text-modern-500 uppercase tracking-wider">æ¨™é¡Œ</th>\n            <th class="px-6 py-3 text-left text-xs font-medium text-modern-500 uppercase tracking-wider">ç‹€æ…‹</th>\n            <th class="px-6 py-3 text-left text-xs font-medium text-modern-500 uppercase tracking-wider">ä½œè€…</th>\n            <th class="px-6 py-3 text-left text-xs font-medium text-modern-500 uppercase tracking-wider">å»ºç«‹æ™‚é–“</th>\n            <th class="px-6 py-3 text-right text-xs font-medium text-modern-500 uppercase tracking-wider">æ“ä½œ</th>\n          </tr>\n        </thead>\n        <tbody class="bg-white divide-y divide-modern-200">\n          ${e.map(t=>`\n            <tr class="hover:bg-modern-50">\n              <td class="px-6 py-4">\n                <div class="text-sm font-medium text-modern-900">${t.title}</div>\n              </td>\n              <td class="px-6 py-4">\n                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${"published"===t.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}">\n                  ${"published"===t.status?"å·²ç™¼å¸ƒ":"è‰ç¨¿"}\n                </span>\n              </td>\n              <td class="px-6 py-4 text-sm text-modern-600">${t.author||"Unknown"}</td>\n              <td class="px-6 py-4 text-sm text-modern-600">${new Date(t.created_at).toLocaleDateString("zh-TW")}</td>\n              <td class="px-6 py-4 text-right text-sm">\n                <div class="flex justify-end gap-2">\n                  <a href="/admin/posts/${t.id}/edit" data-navigo class="px-3 py-1 text-accent-600 hover:bg-accent-50 rounded transition-colors">\n                    ç·¨è¼¯\n                  </a>\n                  <button \n                    onclick="window.togglePostStatus(${t.id}, '${t.status}')" \n                    class="px-3 py-1 text-blue-600 hover:bg-blue-50 rounded transition-colors"\n                  >\n                    ${"published"===t.status?"è½‰è‰ç¨¿":"ç™¼å¸ƒ"}\n                  </button>\n                  <button \n                    onclick="window.deletePost(${t.id})" \n                    class="px-3 py-1 text-red-600 hover:bg-red-50 rounded transition-colors"\n                  >\n                    åˆªé™¤\n                  </button>\n                </div>\n              </td>\n            </tr>\n          `).join("")}\n        </tbody>\n      </table>\n      \n      \x3c!-- åˆ†é  --\x3e\n      ${function(t){if(!t||t.total_pages<=1)return"";const{page:e,total_pages:n}=t,s=[];for(let o=1;o<=n;o++)1===o||o===n||o>=e-2&&o<=e+2?s.push(o):"..."!==s[s.length-1]&&s.push("...");return`\n    <div class="flex items-center justify-between px-6 py-4 border-t border-modern-200">\n      <div class="text-sm text-modern-600">\n        ç¬¬ ${e} é ï¼Œå…± ${n} é \n      </div>\n      <div class="flex gap-2">\n        <button \n          onclick="window.goToPage(${e-1})"\n          ${1===e?"disabled":""}\n          class="px-3 py-1 border border-modern-300 rounded hover:bg-modern-50 disabled:opacity-50 disabled:cursor-not-allowed"\n        >\n          ä¸Šä¸€é \n        </button>\n        ${s.map(t=>"..."===t?'<span class="px-3 py-1">...</span>':`\n            <button \n              onclick="window.goToPage(${t})"\n              class="px-3 py-1 border border-modern-300 rounded hover:bg-modern-50 ${t===e?"bg-accent-600 text-white border-accent-600":""}"\n            >\n              ${t}\n            </button>\n          `).join("")}\n        <button \n          onclick="window.goToPage(${e+1})"\n          ${e===n?"disabled":""}\n          class="px-3 py-1 border border-modern-300 rounded hover:bg-modern-50 disabled:opacity-50 disabled:cursor-not-allowed"\n        >\n          ä¸‹ä¸€é \n        </button>\n      </div>\n    </div>\n  `}(s)}\n    `,d.updatePageLinks()}catch(m){a.hide(),o.innerHTML=`\n      <div class="text-center py-12">\n        <div class="text-6xl mb-4">âš ï¸</div>\n        <p class="text-red-600 mb-4">è¼‰å…¥å¤±æ•—ï¼š${m.message}</p>\n        <button onclick="location.reload()" class="btn-primary">é‡è©¦</button>\n      </div>\n    `}}window.deletePost=async function(t){const e=l.posts.find(e=>e.id===t);if(await o((null==e?void 0:e.title)||"æ­¤æ–‡ç« ")){a.show("åˆªé™¤ä¸­...");try{await n.delete(t),a.hide(),s.success("æ–‡ç« å·²åˆªé™¤"),await p()}catch(d){a.hide(),s.error("åˆªé™¤å¤±æ•—ï¼š"+d.message)}}},window.togglePostStatus=async function(t,e){const o="published"===e?"draft":"published",d="published"===o?"ç™¼å¸ƒ":"è½‰ç‚ºè‰ç¨¿";a.show(`${d}ä¸­...`);try{await n.update(t,{status:o}),a.hide(),s.success(`æ–‡ç« å·²${d}`),await p()}catch(i){a.hide(),s.error(`${d}å¤±æ•—ï¼š`+i.message)}},window.goToPage=function(t){i=t,p()};export{c as renderPostsList};
