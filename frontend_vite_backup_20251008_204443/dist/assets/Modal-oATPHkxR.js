class e{constructor(e={}){this.id=e.id||`modal-${Date.now()}`,this.title=e.title||"",this.content=e.content||"",this.confirmText=e.confirmText||"確定",this.cancelText=e.cancelText||"取消",this.onConfirm=e.onConfirm||null,this.onCancel=e.onCancel||null,this.showCancel=!1!==e.showCancel,this.showFooter=!1!==e.showFooter,this.size=e.size||"md",this.modalElement=null}show(){this._render(),this._bindEvents(),setTimeout(()=>{this.modalElement.classList.add("modal-show")},10),this._setupFocusTrap()}hide(){this.modalElement&&(this.modalElement.classList.remove("modal-show"),setTimeout(()=>{this.modalElement&&this.modalElement.parentNode&&this.modalElement.parentNode.removeChild(this.modalElement),this.modalElement=null},300))}_render(){const e=`\n      <div id="${this.id}" class="modal-overlay fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 opacity-0 transition-opacity duration-300">\n        <div class="modal-content bg-white rounded-lg shadow-xl ${{sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl"}[this.size]} w-full mx-4 transform scale-95 transition-transform duration-300">\n          ${this.title?`\n            <div class="modal-header px-6 py-4 border-b border-modern-200">\n              <h3 class="text-xl font-semibold text-modern-900">${this.title}</h3>\n            </div>\n          `:""}\n          \n          <div class="modal-body px-6 py-4">\n            ${this.content}\n          </div>\n          \n          ${this.showFooter?`\n            <div class="modal-footer px-6 py-4 border-t border-modern-200 flex justify-end gap-3">\n              ${this.showCancel?`\n                <button class="modal-cancel btn-secondary">\n                  ${this.cancelText}\n                </button>\n              `:""}\n              <button class="modal-confirm btn-primary">\n                ${this.confirmText}\n              </button>\n            </div>\n          `:""}\n        </div>\n      </div>\n    `,t=document.createElement("div");t.innerHTML=e,this.modalElement=t.firstElementChild,document.body.appendChild(this.modalElement)}_bindEvents(){this.modalElement.addEventListener("click",e=>{e.target===this.modalElement&&this._handleCancel()});const e=this.modalElement.querySelector(".modal-confirm");e&&e.addEventListener("click",()=>this._handleConfirm());const t=this.modalElement.querySelector(".modal-cancel");t&&t.addEventListener("click",()=>this._handleCancel()),this._escHandler=e=>{"Escape"===e.key&&this._handleCancel()},document.addEventListener("keydown",this._escHandler)}async _handleConfirm(){if(this.onConfirm){!1!==await this.onConfirm()&&this.hide()}else this.hide()}_handleCancel(){this.onCancel&&this.onCancel(),this.hide()}_setupFocusTrap(){const e=this.modalElement.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(0===e.length)return;const t=e[0],n=e[e.length-1];t.focus(),this.modalElement.addEventListener("keydown",e=>{"Tab"===e.key&&(e.shiftKey&&document.activeElement===t?(e.preventDefault(),n.focus()):e.shiftKey||document.activeElement!==n||(e.preventDefault(),t.focus()))})}}export{e as M};
