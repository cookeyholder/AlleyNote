# API ç«¯é»é©—è­‰å ±å‘Š

**æ—¥æœŸ**: 2025-10-11  
**æ¸¬è©¦ç’°å¢ƒ**: Docker (localhost:8080)

## æ¸¬è©¦æ‘˜è¦

å·²é©—è­‰ AlleyNote API çš„æ‰€æœ‰ä¸»è¦ç«¯é»ã€‚ä»¥ä¸‹æ˜¯ç™¼ç¾çš„å•é¡Œå’Œç¢ºèªæœ‰æ•ˆçš„ç«¯é»ã€‚

## âœ… æœ‰æ•ˆçš„ API ç«¯é»

### å…¬é–‹ç«¯é»ï¼ˆç„¡éœ€èªè­‰ï¼‰

| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ | ç‹€æ…‹ç¢¼ |
|------|------|------|--------|
| GET | `/api/health` | å¥åº·æª¢æŸ¥ | 200 |
| GET | `/api/docs` | API æ–‡ä»¶ (JSON) | 200 |
| GET | `/api/docs/ui` | API æ–‡ä»¶ (UI) | 200 |
| GET | `/api/posts` | æ–‡ç« åˆ—è¡¨ | 200 |
| GET | `/api/posts/{id}` | æ–‡ç« è©³æƒ… | 200/404 |
| POST | `/api/auth/login` | ä½¿ç”¨è€…ç™»å…¥ | 200/400 |
| POST | `/api/auth/register` | ä½¿ç”¨è€…è¨»å†Š | 200/400 |
| POST | `/api/auth/refresh` | åˆ·æ–° Token | 200/400 |

### éœ€è¦èªè­‰çš„ç«¯é»

| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ | ç‹€æ…‹ç¢¼ |
|------|------|------|--------|
| GET | `/api/auth/me` | å–å¾—ç•¶å‰ä½¿ç”¨è€…è³‡è¨Š | 200 |
| POST | `/api/auth/logout` | ä½¿ç”¨è€…ç™»å‡º | 200 |
| PUT | `/api/auth/profile` | æ›´æ–°å€‹äººè³‡æ–™ | 200 |
| POST | `/api/auth/change-password` | è®Šæ›´å¯†ç¢¼ | 200 |

### æ–‡ç« ç®¡ç†ï¼ˆéœ€è¦èªè­‰ï¼‰

| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ | ç‹€æ…‹ç¢¼ |
|------|------|------|--------|
| GET | `/api/posts` | æ–‡ç« åˆ—è¡¨ | 200 |
| GET | `/api/posts/{id}` | æ–‡ç« è©³æƒ… | 200 |
| POST | `/api/posts` | å»ºç«‹æ–‡ç«  | 201/422 |
| PUT | `/api/posts/{id}` | æ›´æ–°æ–‡ç«  | 200 |
| DELETE | `/api/posts/{id}` | åˆªé™¤æ–‡ç«  | 204 |
| POST | `/api/posts/{id}/publish` | ç™¼å¸ƒæ–‡ç«  | 200 |
| POST | `/api/posts/{id}/unpublish` | å–æ¶ˆç™¼å¸ƒæ–‡ç«  | 200 |
| PATCH | `/api/posts/{id}/pin` | ç½®é ‚/å–æ¶ˆç½®é ‚æ–‡ç«  | 200 |

### ä½¿ç”¨è€…ç®¡ç†ï¼ˆéœ€è¦ç®¡ç†å“¡æ¬Šé™ï¼‰

| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ | ç‹€æ…‹ç¢¼ |
|------|------|------|--------|
| GET | `/api/users` | ä½¿ç”¨è€…åˆ—è¡¨ | 200 |
| GET | `/api/users/{id}` | ä½¿ç”¨è€…è©³æƒ… | 200 |
| POST | `/api/users` | å»ºç«‹ä½¿ç”¨è€… | 201 |
| PUT | `/api/users/{id}` | æ›´æ–°ä½¿ç”¨è€… | 200 |
| DELETE | `/api/users/{id}` | åˆªé™¤ä½¿ç”¨è€… | 204 |
| POST | `/api/users/{id}/activate` | å•Ÿç”¨ä½¿ç”¨è€… | 200 |
| POST | `/api/users/{id}/deactivate` | åœç”¨ä½¿ç”¨è€… | 200 |
| POST | `/api/users/{id}/reset-password` | é‡è¨­å¯†ç¢¼ | 200 |

### è§’è‰²èˆ‡æ¬Šé™ç®¡ç†ï¼ˆéœ€è¦ç®¡ç†å“¡æ¬Šé™ï¼‰

| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ | ç‹€æ…‹ç¢¼ |
|------|------|------|--------|
| GET | `/api/roles` | è§’è‰²åˆ—è¡¨ | 200 |
| GET | `/api/roles/{id}` | è§’è‰²è©³æƒ… | 200 |
| POST | `/api/roles` | å»ºç«‹è§’è‰² | 201 |
| PUT | `/api/roles/{id}` | æ›´æ–°è§’è‰² | 200 |
| DELETE | `/api/roles/{id}` | åˆªé™¤è§’è‰² | 204 |
| PUT | `/api/roles/{id}/permissions` | æ›´æ–°è§’è‰²æ¬Šé™ | 200 |
| GET | `/api/permissions` | æ¬Šé™åˆ—è¡¨ | 200 |
| GET | `/api/permissions/{id}` | æ¬Šé™è©³æƒ… | 200 |
| GET | `/api/permissions/grouped` | åˆ†çµ„æ¬Šé™åˆ—è¡¨ | 200 |

### ç³»çµ±è¨­å®šï¼ˆéœ€è¦ç®¡ç†å“¡æ¬Šé™ï¼‰

| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ | ç‹€æ…‹ç¢¼ |
|------|------|------|--------|
| GET | `/api/settings` | å–å¾—ç³»çµ±è¨­å®š | 200 |
| PUT | `/api/settings` | æ›´æ–°ç³»çµ±è¨­å®š | 200 |
| GET | `/api/settings/{key}` | å–å¾—å–®ä¸€è¨­å®š | 200 |
| PUT | `/api/settings/{key}` | æ›´æ–°å–®ä¸€è¨­å®š | 200 |

### çµ±è¨ˆåŠŸèƒ½ï¼ˆéœ€è¦èªè­‰ï¼‰

| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ | ç‹€æ…‹ç¢¼ |
|------|------|------|--------|
| GET | `/api/statistics/overview` | çµ±è¨ˆæ¦‚è¦½ | 200 |
| GET | `/api/statistics/posts` | æ–‡ç« çµ±è¨ˆ | 200 |
| GET | `/api/statistics/sources` | ä¾†æºçµ±è¨ˆ | 200 |
| GET | `/api/statistics/users` | ä½¿ç”¨è€…çµ±è¨ˆ | 200 |
| GET | `/api/statistics/popular` | ç†±é–€å…§å®¹çµ±è¨ˆ | 200 |
| POST | `/api/posts/{id}/view` | è¨˜éŒ„æ–‡ç« ç€è¦½ | 200 |

### çµ±è¨ˆç®¡ç†ï¼ˆéœ€è¦ç®¡ç†å“¡æ¬Šé™ï¼‰

| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ | ç‹€æ…‹ç¢¼ |
|------|------|------|--------|
| POST | `/api/admin/statistics/refresh` | æ‰‹å‹•åˆ·æ–°çµ±è¨ˆ | 200 |
| DELETE | `/api/admin/statistics/cache` | æ¸…é™¤çµ±è¨ˆå¿«å– | 200 |

## âŒ ç„¡æ•ˆæˆ–æœªå¯¦ä½œçš„ç«¯é»

### Tags API

**å•é¡Œ**: `/api/tags` ç›¸é—œç«¯é»å›å‚³ 404

**è·¯ç”±å®šç¾©å­˜åœ¨ä½†æœªæ­£å¸¸å·¥ä½œ**:
- GET `/api/tags` - æ¨™ç±¤åˆ—è¡¨
- GET `/api/tags/{id}` - æ¨™ç±¤è©³æƒ…
- POST `/api/tags` - å»ºç«‹æ¨™ç±¤
- PUT `/api/tags/{id}` - æ›´æ–°æ¨™ç±¤
- DELETE `/api/tags/{id}` - åˆªé™¤æ¨™ç±¤

**åŸå› **: TagController å­˜åœ¨ä½†è·¯ç”±å¯èƒ½æœªæ­£ç¢ºè¨»å†Š

**å»ºè­°**: æª¢æŸ¥ TagController å’Œè·¯ç”±é…ç½®

### Timezone Info API

**å•é¡Œ**: `/api/timezone-info` å›å‚³ 404

**è·¯ç”±å®šç¾©**: `GET /api/timezone-info` - å–å¾—æ™‚å€è³‡è¨Š

**åŸå› **: SettingController ä¸­æœ‰ `getTimezoneInfo` æ–¹æ³•ï¼Œä½†è·¯ç”±æœªç”Ÿæ•ˆ

**å»ºè­°**: æª¢æŸ¥è·¯ç”±è¨»å†Š

### Activity Logs API

**å•é¡Œ**: `/api/v1/activity-logs` ç›¸é—œç«¯é»å›å‚³ 404

**è·¯ç”±å®šç¾©å­˜åœ¨ä½†è·¯å¾‘ä¸æ­£ç¢º**:
- GET `/api/v1/activity-logs` - æŸ¥è©¢æ´»å‹•è¨˜éŒ„
- POST `/api/v1/activity-logs` - è¨˜éŒ„æ´»å‹•
- GET `/api/v1/activity-logs/stats` - æ´»å‹•çµ±è¨ˆ
- GET `/api/v1/activity-logs/me` - ç•¶å‰ä½¿ç”¨è€…æ´»å‹•

**åŸå› **: ActivityLogController å¯èƒ½æœªæ­£ç¢ºæ•´åˆ

**å»ºè­°**: å¯¦ä½œæˆ–ç§»é™¤é€™äº›ç«¯é»

## ğŸ” Swagger/OpenAPI æ–‡ä»¶å•é¡Œ

### è·¯å¾‘å‰ç¶´ä¸ä¸€è‡´

Swagger æ–‡ä»¶ä¸­çš„è·¯å¾‘ç¼ºå°‘ `/api` å‰ç¶´ï¼š
- æ–‡ä»¶ä¸­: `/posts/{id}`
- å¯¦éš›è·¯å¾‘: `/api/posts/{id}`

### çµ±è¨ˆ API è·¯å¾‘éŒ¯èª¤

Swagger æ–‡ä»¶ä¸­é¡¯ç¤º:
- `/api/v1/statistics/*`

å¯¦éš›è·¯å¾‘æ‡‰è©²æ˜¯:
- `/api/statistics/*`

## ğŸ“‹ å»ºè­°ä¿®æ­£

1. **ä¿®æ­£æˆ–ç§»é™¤ Tags API**
   - é¸é … A: å¯¦ä½œå®Œæ•´çš„ TagController åŠŸèƒ½
   - é¸é … B: å¾æ–‡ä»¶å’Œè·¯ç”±ä¸­ç§»é™¤

2. **ä¿®æ­£ Timezone Info API**
   - æª¢æŸ¥è·¯ç”±è¨»å†Šå•é¡Œ
   - ç¢ºèª SettingController::getTimezoneInfo() å¯æ­£å¸¸å‘¼å«

3. **ä¿®æ­£ Activity Logs API**
   - å®Œæˆ ActivityLogController æ•´åˆ
   - æˆ–å¾æ–‡ä»¶ä¸­ç§»é™¤æœªå¯¦ä½œçš„ç«¯é»

4. **æ›´æ–° Swagger æ–‡ä»¶**
   - çµ±ä¸€è·¯å¾‘å‰ç¶´ï¼ˆåŠ å…¥ `/api`ï¼‰
   - ä¿®æ­£çµ±è¨ˆ API è·¯å¾‘ï¼ˆç§»é™¤ `/v1`ï¼‰
   - ç§»é™¤ç„¡æ•ˆç«¯é»çš„æ–‡ä»¶

5. **æ›´æ–° QUICK_START.md**
   - API æ–‡ä»¶è·¯å¾‘æ”¹ç‚º `/api/docs/ui`ï¼ˆå·²ç¢ºèªæœ‰æ•ˆï¼‰
   - åˆ—å‡ºå¯¦éš›å¯ç”¨çš„ä¸»è¦ç«¯é»

## âœ… æ¸¬è©¦å¸³è™Ÿç¢ºèª

| è§’è‰² | é›»å­ä¿¡ç®± | å¯†ç¢¼ |
|------|----------|------|
| ç®¡ç†å“¡ | admin@example.com | password |

**ç™»å…¥å›æ‡‰æ ¼å¼**:
```json
{
  "success": true,
  "message": "ç™»å…¥æˆåŠŸ",
  "access_token": "eyJ0eXAiOiJKV1Q...",
  "refresh_token": "eyJ0eXAiOiJKV1Q...",
  "token_type": "Bearer",
  "expires_in": 2592000,
  "user": {
    "id": 1,
    "email": "admin@example.com",
    "name": "admin",
    "role": "super_admin"
  }
}
```

## ğŸ¯ çµè«–

å¤§éƒ¨åˆ†æ ¸å¿ƒ API ç«¯é»éƒ½æ­£å¸¸é‹ä½œï¼š
- âœ… èªè­‰ç³»çµ±å®Œæ•´æœ‰æ•ˆ
- âœ… æ–‡ç« ç®¡ç†åŠŸèƒ½å®Œæ•´
- âœ… ä½¿ç”¨è€…ç®¡ç†åŠŸèƒ½å®Œæ•´
- âœ… è§’è‰²æ¬Šé™ç®¡ç†å®Œæ•´
- âœ… çµ±è¨ˆåŠŸèƒ½æœ‰æ•ˆï¼ˆè·¯å¾‘ç‚º `/api/statistics/`ï¼‰
- âŒ Tags API éœ€è¦ä¿®æ­£
- âŒ Timezone Info API éœ€è¦ä¿®æ­£
- âŒ Activity Logs API å¯èƒ½æœªå®Œæˆå¯¦ä½œ

å»ºè­°å„ªå…ˆä¿®æ­£æ–‡ä»¶ï¼Œå°‡ç„¡æ•ˆç«¯é»æ¨™è¨»æˆ–ç§»é™¤ï¼Œç¢ºä¿ä½¿ç”¨è€…ä¸æœƒå˜—è©¦å‘¼å«ç„¡æ•ˆçš„ APIã€‚
